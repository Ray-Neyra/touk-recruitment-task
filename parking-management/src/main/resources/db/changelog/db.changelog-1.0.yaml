databaseChangeLog:
  - changeSet:
      id: 1.0-1
      author: Konrad Farkowski
      changes:
        - createSequence:
            sequenceName: drivers_seq
            incrementBy: 50
            startValue: 100
        - createTable:
            columns:
              - column:
                  name: id
                  type: bigint
                  value: drivers_seq
                  constraints:
                    primaryKey: true
              - column:
                  name: uuid
                  type: VARCHAR(36)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: name
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: surname
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: role
                  type: VARCHAR(64)
                  constraints:
                    nullable: false
              - column:
                  name: driver_type
                  type: VARCHAR(64)
                  constraints:
                    nullable: false
            tableName: drivers
  - changeSet:
      id: 1.0-2
      author: Konrad Farkowski
      changes:
        - createSequence:
            sequenceName: vehicles_seq
            incrementBy: 50
            startValue: 100
        - createTable:
            columns:
              - column:
                  name: id
                  type: bigint
                  value: vehicles_seq
                  constraints:
                    primaryKey: true
              - column:
                  name: uuid
                  type: VARCHAR(36)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: registration_number
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
                    unique: true
            tableName: vehicles
  - changeSet:
      id: 1.0-3
      author: Konrad Farkowski
      changes:
        - createTable:
            columns:
              - column:
                  name: driver_id
                  type: bigint
                  constraints:
                    foreignKeyName: fk_drivers_drivers_vehicles
                    references: drivers(id)
                    nullable: false
              - column:
                  name: vehicle_id
                  type: bigint
                  constraints:
                    foreignKeyName: fk_vehicles_drivers_vehicles
                    references: vehicles(id)
                    nullable: false
            tableName: drivers_vehicles
  - changeSet:
      id: 1.0-4
      author: Konrad Farkowski
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: code
                  type: VARCHAR(3)
                  constraints:
                    nullable: false
                    unique: true
            tableName: currencies
  - changeSet:
      id: 1.0-5
      author: Konrad Farkowski
      changes:
        - createSequence:
            sequenceName: parking_rates_seq
            incrementBy: 50
            startValue: 100
        - createTable:
            columns:
              - column:
                  name: id
                  type: bigint
                  value: parking_rates_seq
                  constraints:
                    primaryKey: true
              - column:
                  name: uuid
                  type: VARCHAR(36)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: active
                  type: boolean
                  constraints:
                    nullable: false
              - column:
                  name: first_hour_rate
                  type: numeric(19,2)
                  constraints:
                    nullable: false
              - column:
                  name: second_hour_rate
                  type: numeric(19,2)
                  constraints:
                    nullable: false
              - column:
                  name: multiplier
                  type: numeric(19,2)
                  constraints:
                    nullable: false
              - column:
                  name: driver_type_code
                  type: int
                  constraints:
                    nullable: false
              - column:
                  name: currency_id
                  type: bigint
                  constraints:
                    foreignKeyName: fk_currencies_parking_rates
                    references: currencies(id)
                    nullable: false
            tableName: parking_rates
  - changeSet:
      id: 1.0-6
      author: Konrad Farkowski
      changes:
        - createSequence:
            sequenceName: parkings_seq
            incrementBy: 50
            startValue: 100
        - createTable:
            columns:
              - column:
                  name: id
                  type: bigint
                  valueComputed: parkings_seq
                  constraints:
                    primaryKey: true
              - column:
                  name: uuid
                  type: VARCHAR(36)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: vehicle_id
                  type: bigint
                  constraints:
                    foreignKeyName: fk_vehicles_parkings
                    references: vehicles(id)
                    nullable: false
              - column:
                  name: driver_id
                  type: bigint
                  constraints:
                    foreignKeyName: fk_drivers_parkings
                    references: drivers(id)
                    nullable: false
              - column:
                  name: start_date
                  type: timestamp with time zone
                  constraints:
                    nullable: false
              - column:
                  name: end_date
                  type: timestamp with time zone
                  constraints:
                    nullable: true
              - column:
                  name: paid
                  type: boolean
                  constraints:
                    nullable: false
            tableName: parkings
  - changeSet:
      id: 1.0-7
      author: Konrad Farkowski
      changes:
        - createSequence:
            sequenceName: payments_seq
            incrementBy: 50
            startValue: 100
        - createTable:
            columns:
              - column:
                  name: id
                  type: bigint
                  value: payments_seq
                  constraints:
                    primaryKey: true
              - column:
                  name: uuid
                  type: VARCHAR(36)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: parking_id
                  type: bigint
                  constraints:
                    foreignKeyName: fk_parkings_payments
                    references: parkings(id)
                    nullable: false
                    unique: true
              - column:
                  name: fee
                  type: numeric(19,2)
                  constraints:
                    nullable: false
              - column:
                  name: currency_code
                  type: VARCHAR(3)
                  constraints:
                    nullable: false
              - column:
                  name: payment_date
                  type: date
                  defaultValue: ${now}
                  constraints:
                    nullable: false
            tableName: payments

  - include:
      file: db/sql/initial-insert.sql
